<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Feature Selection in rMVPA • rMVPA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Feature Selection in rMVPA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rMVPA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Feature Selection in rMVPA</h1>
                        <h4 data-toc-skip class="author">Bradley
Buchsbaum</h4>
            
            <h4 data-toc-skip class="date">2025-09-27</h4>
      

      <div class="d-none name"><code>FeatureSelection.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Neuroimaging datasets often contain far more features than
informative signal. Feature selection reduces dimensionality, improves
interpretability, and can boost predictive performance—provided it is
performed inside the cross‑validation loop to avoid selection bias. In
<code>rMVPA</code>, you configure selection with a feature‑selector
object. The package supports an ANOVA‑based F‑test (“FTest”) and
correlation‑adjusted t‑scores (“catscore”, via <code>sda.ranking</code>)
to rank features, together with simple cutoffs: keep the top
<code>k</code> features or the top proportion <code>p</code> (e.g.,
<code>p = 0.1</code> keeps the top 10%).</p>
</div>
<div class="section level2">
<h2 id="creating-a-feature-selector-object">Creating a Feature Selector Object<a class="anchor" aria-label="anchor" href="#creating-a-feature-selector-object"></a>
</h2>
<p>To create a feature selector in <code>rMVPA</code>, use the
<code><a href="../reference/feature_selector.html">feature_selector()</a></code> function. For example, to construct a
feature selector using the FTest method with a top_k cutoff (selecting
the top 10 features):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bbuchsbaum.github.io/rMVPA/">rMVPA</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Create a feature selector using FTest with top_k cutoff (select top 10 features)</span></span>
<span><span class="va">fsel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/feature_selector.html">feature_selector</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"FTest"</span>, cutoff_type <span class="op">=</span> <span class="st">"top_k"</span>, cutoff_value <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">fsel</span></span></code></pre></div>
<pre><code><span><span class="co">## Feature Selector Object\n-----------------------\nMethod:         FTest \nCutoff Type:    top_k \nCutoff Value:   10 \n</span></span></code></pre>
<p>Similarly, you can create a feature selector that selects a
proportion of features using the top_p option. In the example below, we
select the top 10% of features based on the FTest ranking:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a feature selector using FTest with top_p cutoff (select top 10% of features)</span></span>
<span><span class="va">fsel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/feature_selector.html">feature_selector</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"FTest"</span>, cutoff_type <span class="op">=</span> <span class="st">"top_p"</span>, cutoff_value <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">fsel</span></span></code></pre></div>
<pre><code><span><span class="co">## Feature Selector Object\n-----------------------\nMethod:         FTest \nCutoff Type:    top_p \nCutoff Value:   0.1 \n</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="applying-feature-selection-to-data">Applying Feature Selection to Data<a class="anchor" aria-label="anchor" href="#applying-feature-selection-to-data"></a>
</h2>
<p>The <code><a href="../reference/select_features-methods.html">select_features()</a></code> function applies the feature
selection process to a given feature matrix <code>X</code> and a
response variable <code>Y</code>. The function returns a logical vector
with <code>TRUE</code> for selected features and <code>FALSE</code>
otherwise.</p>
<p>Below is an example using simulated data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate a response variable (categorical)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a feature matrix with 100 samples and 100 features</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span>, ncol <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply feature selection using the FTest method with top_k cutoff</span></span>
<span><span class="va">fsel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/feature_selector.html">feature_selector</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"FTest"</span>, cutoff_type <span class="op">=</span> <span class="st">"top_k"</span>, cutoff_value <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">selected_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_features-methods.html">select_features</a></span><span class="op">(</span><span class="va">fsel</span>, <span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The number of selected features should be equal to the cutoff value (10)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of selected features (top_k):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Number of selected features (top_k): 10</span></span></code></pre>
<p>Now, let’s use the top_p option. This will select a proportion of the
features. For example, with a cutoff value of 0.1, the top 10% of
features will be selected:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply feature selection using the FTest method with top_p cutoff (select top 10% of features)</span></span>
<span><span class="va">fsel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/feature_selector.html">feature_selector</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"FTest"</span>, cutoff_type <span class="op">=</span> <span class="st">"top_p"</span>, cutoff_value <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">selected_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_features-methods.html">select_features</a></span><span class="op">(</span><span class="va">fsel</span>, <span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the proportion of features selected</span></span>
<span><span class="va">the_proportion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Proportion of features selected (top_p):"</span>, <span class="va">the_proportion</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Proportion of features selected (top_p): 0.1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="using-the-catscore-method">Using the catscore Method<a class="anchor" aria-label="anchor" href="#using-the-catscore-method"></a>
</h2>
<p>Alternatively, you can use the <code>catscore</code> method to
perform feature selection. The <code>catscore</code> method computes a
correlation-adjusted t-score for each feature. Here’s an example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a feature selector using catscore with top_k cutoff (select top 10 features)</span></span>
<span><span class="va">fsel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/feature_selector.html">feature_selector</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"catscore"</span>, cutoff_type <span class="op">=</span> <span class="st">"top_k"</span>, cutoff_value <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a response variable and feature matrix</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">90</span> <span class="op">*</span> <span class="fl">50</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">90</span>, ncol <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply feature selection using catscore</span></span>
<span><span class="va">selected_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_features-methods.html">select_features</a></span><span class="op">(</span><span class="va">fsel</span>, <span class="va">X</span>, <span class="va">Y</span>, ranking.score <span class="op">=</span> <span class="st">"entropy"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of features selected using catscore (top_k):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">selected_features</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Number of features selected using catscore (top_k): 10</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Feature selection is a powerful tool to reduce dimensionality in
high-dimensional datasets, especially in neuroimaging applications. In
<code>rMVPA</code>, the integration of feature selection into
cross-validation workflows helps ensure that models are built on
unbiased, relevant subsets of data. You can choose between different
methods (FTest or catscore) and cutoff strategies (top_k vs top_p) based
on your specific analysis needs.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
