<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rMVPA">
<title>Command-Line Scripts • rMVPA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Command-Line Scripts">
<meta property="og:description" content="rMVPA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rMVPA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/CommandLineScripts.html">Command-Line Scripts</a>
    <a class="dropdown-item" href="../articles/CrossValidation.html">Cross-Validation Schemes</a>
    <a class="dropdown-item" href="../articles/FeatureSelection.html">Feature Selection</a>
    <a class="dropdown-item" href="../articles/RSA.html">Represenational Similarity Analysis</a>
    <a class="dropdown-item" href="../articles/Regional_Analysis.html">Regional Analysis</a>
    <a class="dropdown-item" href="../articles/Searchlight_Analysis.html">Searchlight Analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Command-Line Scripts</h1>
                        <h4 data-toc-skip class="author">Bradley
Buchsbaum</h4>
            
            <h4 data-toc-skip class="date">2023-04-27</h4>
      
      
      <div class="d-none name"><code>CommandLineScripts.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="running-rmvpa-algorithms-from-the-command-line">Running rMVPA algorithms from the command line<a class="anchor" aria-label="anchor" href="#running-rmvpa-algorithms-from-the-command-line"></a>
</h3>
<p><code>rMVPA</code> offers two main command-line executable R scripts
that can be used to run most basic MVPA analyses. The goal of these
scripts is to get users up and running without requiring them to write
full-blown R programs. Instead, rMVPA can be controlled via a
configuration file that specifies the data, design information, block
structure, model parameters, etc. that are necessary to run an MVPA
analysis.</p>
<p>There are currently two main scripts: <code>MVPA_Searchlight.R</code>
and <code>MVPA_Regional.R</code>. These two scripts are very similar in
their inputs and capabilities–the difference is really only that the
former runs a “searchlight” analysis and the latter runs an MVPA over a
set of one or more regions of interest (ROI). For example, if one wished
to run MVPA using a single large mask covering visual cortex, or over a
set of Freesrufer-defined ROIs, one would opt for
<code>MVPA_Regional.R</code>.</p>
</div>
<div class="section level2">
<h2 id="installing-the-command-line-scripts">Installing the command-line scripts<a class="anchor" aria-label="anchor" href="#installing-the-command-line-scripts"></a>
</h2>
<p><code>MVPA_Searchlight.R</code> and <code>MVPA_Regional.R</code> are
stored in the <code>scripts</code> sub-directory of the R project
located here:</p>
<p><a href="https://github.com/bbuchsbaum/rMVPA" class="external-link uri">https://github.com/bbuchsbaum/rMVPA</a></p>
<p>Of course, before you can the scripts, you need to have rMVPA
installed. Easiest way is to open an R console and type following
command, assuming <code>devtools</code> is alreeady installed. If not,
first install the <code>devtools</code> package.</p>
<p>Installing the rMVPA package, however, will not install the command
line scripts. Instead, you have to do this manually.</p>
</div>
<div class="section level2">
<h2 id="using-wget-to-fetch-scripts-from-github">Using <code>wget</code> to fetch scripts from Github<a class="anchor" aria-label="anchor" href="#using-wget-to-fetch-scripts-from-github"></a>
</h2>
<p>An easy way to do this is with the <code>wget</code> command.</p>
<p><code>wget https://raw.githubusercontent.com/bbuchsbaum/rMVPA/master/scripts/MVPA_Searchlight.R</code></p>
<p><code>wget https://raw.githubusercontent.com/bbuchsbaum/rMVPA/master/scripts/MVPA_Regional.R</code></p>
</div>
<div class="section level2">
<h2 id="adding-scripts-to-your-bin-folder-and-making-them-executable">Adding scripts to your <code>bin</code> folder and making them
executable<a class="anchor" aria-label="anchor" href="#adding-scripts-to-your-bin-folder-and-making-them-executable"></a>
</h2>
<p>Then, you generally want to move these to a <code>bin</code>
directory either locally (e.g. <code>/home/username/bin</code> or at the
system level <code>/usr/local/bin</code>).</p>
<p>e.g. <code>cp MVPA_*R /home/username/bin</code> where
<code>username</code> is the name of your login id.</p>
<p>Finally, you need to make the script executable:</p>
<p><code>cd /home/username/bin</code>
<code>chmod +x MVPA_Searchlight.R</code>
<code>chmod +x MVPA_Regional.R</code></p>
<p>Now you can test whether the script is working (assuming that the
files are on your <code>PATH</code>):</p>
<p><code>MVPA_Searchlight.R --help</code></p>
<p><code>MVPA_Regional.R --help</code></p>
</div>
<div class="section level2">
<h2 id="searchlight-analyses-with-mvpa_searchlight-r">Searchlight analyses with MVPA_Searchlight.R<a class="anchor" aria-label="anchor" href="#searchlight-analyses-with-mvpa_searchlight-r"></a>
</h2>
<div class="section level3">
<h3 id="setting-up-a-configuration-file">Setting up a configuration file<a class="anchor" aria-label="anchor" href="#setting-up-a-configuration-file"></a>
</h3>
<p>To run a searchlight analysis we need a minimum of five pieces of
information.</p>
<ul>
<li><p><strong>train_data</strong>: One or more NifTI 4D files
containing trialwise (i.e. one value per voxel per trial) estimates of
brain activity–often colloquially referrrd to as the “betas” because
they are derived from single-trial regression analysis yielding a series
of beta estimates.</p></li>
<li><p><strong>train_design</strong>: A tabular plain text file (“design
file”“) which contains at a minimum the”label” associated with each
image in the “betas” files.</p></li>
<li><p><strong>label_column</strong>: The name of the column in the
above design file that holds the “labels”.</p></li>
<li><p><strong>model</strong>: the name of the classifier model such as
<code>sda_notune</code> for tuning-parameter-free shrinkage discriminant
analysis.</p></li>
<li><p><strong>output</strong>: the name of the folder to place the
searchlight classification results.</p></li>
</ul>
<p>This information is included in a configuration file which can be a
simple R source code file (e.g. “config.R”) or a YAML formatted file
(e.g. config.yaml).</p>
<p>The following additional information can also be specified:</p>
<ul>
<li><p><strong>cross_validation</strong>: the cross-validation method to
be used (see below for examples, also see “CrossValidation”
vignette).</p></li>
<li><p><strong>mask</strong>: the name of a brain mask file that
indicates the set of voxels to include in the searchlight.</p></li>
<li><p><strong>block_column</strong>: the name of the column in the
design file that encodes the block structure of the experiment. This is
especially important for fMRI designs, where the session is divided into
contiguous “blocks” or “runs”. These blocks generally should be “kept
together” during cross-validaiton based procedures. Thus, it is
important in such cases to put this block information as a usually
integer-valued column in the “train_design” tabular text file.</p></li>
<li><p><strong>radius</strong>: the radius in millimeters of the
searchlight. The default value here is 8 but slightly smaller or larger
values are also reasonable.</p></li>
<li><p><strong>normalize</strong>: whether to standardize each
<em>image</em> in the training data by subtracting the mean image and
dividing by the standard deviation. If successive trialwise estimates
vary considerably in terms of whole-image variance or mean, then
normalizing the images can be beneficial. On the other hand, if
whole-brain mean/variance is a meaningful signal for your problem, then
you may not want to normalize in this way.</p></li>
<li><p><strong>type</strong>: the <em>type</em> of the searchlight. This
can either be “standard” or “randomized”. A standard searchlight
involves estimating a classifier model at the center of over voel in the
mask; a randomized searchlight uses an iterative montecarlo resampling
approach to estimate the infromational contribution of each voxel to
classification performance.</p></li>
<li><p><strong>niter</strong>: when <strong>type</strong> is
“randomized” this parameter supplies the number of resampling iterations
(default = 16).</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="an-example-configuation-file-">An example configuation file.<a class="anchor" aria-label="anchor" href="#an-example-configuation-file-"></a>
</h2>
<p>Assume we have a training dataset consisting a set of 100 single
trial “betas” collected over five runs and concatenated together into a
single file called “betas.nii”.</p>
<p>Further assume our classiification goal is to predict whether a
presented stimulus is one of four possible categories:
<strong>face</strong>, <strong>scene</strong>, <strong>object</strong>,
or <strong>word</strong>.</p>
<p>This information is included in a design file called
“train_design.txt” that looks like this (first 5 rows only):</p>
<table class="table">
<thead><tr class="header">
<th align="left">label</th>
<th align="right">repnum</th>
<th align="right">run</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">face</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">scene</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">object</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">word</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">face</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Here is a minimal <code>config.R</code> file.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train_design</span> <span class="op">=</span> <span class="st">"train_design.txt"</span></span>
<span><span class="va">train_data</span> <span class="op">=</span> <span class="st">"betas.nii"</span></span>
<span><span class="va">label_column</span> <span class="op">=</span> <span class="st">"label"</span></span>
<span><span class="va">block_column</span><span class="op">=</span><span class="st">"run"</span></span>
<span><span class="va">radius</span><span class="op">=</span><span class="fl">6</span></span>
<span><span class="va">mask</span> <span class="op">=</span> <span class="st">"brain_mask.nii"</span></span>
<span><span class="va">mode</span> <span class="op">=</span> <span class="st">"sda_notune"</span></span>
<span><span class="va">output</span> <span class="op">=</span> <span class="st">"searchlight_analysis"</span></span></code></pre></div>
<p>Now to run, we type the following command (assuming that
<code>MVPA_Searchlight.R</code> in on you <code>PATH</code>):</p>
<p><code>MVPA_Searchlight.R --config config.R</code></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
