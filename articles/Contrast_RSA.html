<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Contrast RSA with contrast_rsa_model • rMVPA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Contrast RSA with contrast_rsa_model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rMVPA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Contrast RSA with contrast_rsa_model</h1>
                        <h4 data-toc-skip class="author">Bradley
Buchsbaum</h4>
            
            <h4 data-toc-skip class="date">2025-09-27</h4>
      

      <div class="d-none name"><code>Contrast_RSA.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code><a href="../reference/contrast_rsa_model.html">contrast_rsa_model()</a></code> implements the Multi-Dimensional
Signed Representational Voxel Encoding (MS-ReVE) approach. It relates
voxel patterns to a set of predefined contrasts and produces maps that
summarize how each contrast contributes to the local representational
geometry.</p>
<p>This vignette walks through a minimal example and explains the
available output metrics.</p>
</div>
<div class="section level2">
<h2 id="example-setup">Example setup<a class="anchor" aria-label="anchor" href="#example-setup"></a>
</h2>
<p>We start by generating a small example dataset and defining two
contrasts. The contrasts should be column centered so that positive
values indicate conditions that pull voxels in one direction and
negative values pull in the opposite direction.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate dummy dataset (small 6x6x6 volume, 32 samples)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">data_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_sample_dataset.html">gen_sample_dataset</a></span><span class="op">(</span>D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">32</span>, blocks <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># mvpa_dataset object</span></span>
<span><span class="va">mvpa_dat</span> <span class="op">&lt;-</span> <span class="va">data_info</span><span class="op">$</span><span class="va">dataset</span></span>
<span></span>
<span><span class="co"># Design with two simple contrasts across four conditions</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nresponses.html">nresponses</a></span><span class="op">(</span><span class="va">data_info</span><span class="op">$</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="va">C_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">K</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">C_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data_info</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">C_mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>; <span class="va">C_mat</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">C_mat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>; <span class="va">C_mat</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">C_mat</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">C_mat</span>, center <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">C_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AB_vs_CD"</span>, <span class="st">"A_vs_B"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ms_des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msreve_design.html">msreve_design</a></span><span class="op">(</span><span class="va">data_info</span><span class="op">$</span><span class="va">design</span>, contrast_matrix <span class="op">=</span> <span class="va">C_mat</span><span class="op">)</span></span></code></pre></div>
<p>Next we create the model specification and run a tiny searchlight
over the volume. Here we request the default <code>"beta_delta"</code>
metric.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cv_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_validation.html">blocked_cross_validation</a></span><span class="op">(</span><span class="va">data_info</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">block_var</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/contrast_rsa_model.html">contrast_rsa_model</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="va">mvpa_dat</span>,</span>
<span>  design <span class="op">=</span> <span class="va">ms_des</span>,</span>
<span>  output_metric <span class="op">=</span> <span class="st">"beta_delta"</span>,</span>
<span>  check_collinearity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cv_spec <span class="op">=</span> <span class="va">cv_spec</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run a very small searchlight iterator</span></span>
<span><span class="va">slight</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_searchlight.html">get_searchlight</a></span><span class="op">(</span><span class="va">model_spec</span><span class="op">$</span><span class="va">dataset</span>, type <span class="op">=</span> <span class="st">"standard"</span>, radius <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">center_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">model_spec</span><span class="op">$</span><span class="va">dataset</span><span class="op">$</span><span class="va">mask</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">iter_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvpa_iterate.html">mvpa_iterate</a></span><span class="op">(</span><span class="va">model_spec</span>, <span class="va">slight</span>, <span class="va">center_indices</span>, analysis_type <span class="op">=</span> <span class="st">"searchlight"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:29] ⚡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:30] ⚡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:31] ⚡ Processing batch <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:32] ⚡ Processing batch <span style="color: #0000BB;">4</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:33] ⚡ Processing batch <span style="color: #0000BB;">5</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:34] ⚡ Processing batch <span style="color: #0000BB;">6</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:36] ⚡ Processing batch <span style="color: #0000BB;">7</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:37] ⚡ Processing batch <span style="color: #0000BB;">8</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:38] ⚡ Processing batch <span style="color: #0000BB;">9</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:39] ⚡ Processing batch <span style="color: #0000BB;">10</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-09-27 21:51:40] </span></span>
<span><span class="co">## ✨ MVPA Iteration Complete</span></span>
<span><span class="co">## ├─ Total ROIs: <span style="color: #0000BB;">120</span></span></span>
<span><span class="co">## ├─ Processed: <span style="color: #0000BB;">120</span></span></span>
<span><span class="co">## └─ Skipped: <span style="color: #BBBB00;">0</span></span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inspect the beta_delta metric for the first few centers</span></span>
<span><span class="va">preview_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iter_res</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">preview_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">preview_ids</span>, <span class="kw">function</span><span class="op">(</span><span class="va">idx</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">vals</span> <span class="op">&lt;-</span> <span class="va">iter_res</span><span class="op">$</span><span class="va">performance</span><span class="op">[[</span><span class="va">idx</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">beta_delta</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    center_id <span class="op">=</span> <span class="va">iter_res</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span>,</span>
<span>    contrast <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">vals</span><span class="op">)</span>,</span>
<span>    beta_delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">vals</span><span class="op">)</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">preview_tbl</span></span></code></pre></div>
<pre><code><span><span class="co">##    center_id contrast   beta_delta</span></span>
<span><span class="co">## 1         22 AB_vs_CD -0.732517139</span></span>
<span><span class="co">## 2         22   A_vs_B -0.057170966</span></span>
<span><span class="co">## 3         45 AB_vs_CD -0.097480423</span></span>
<span><span class="co">## 4         45   A_vs_B -0.086342936</span></span>
<span><span class="co">## 5         46 AB_vs_CD -0.261304552</span></span>
<span><span class="co">## 6         46   A_vs_B  0.033916449</span></span>
<span><span class="co">## 7         47 AB_vs_CD -0.064381988</span></span>
<span><span class="co">## 8         47   A_vs_B  0.346159334</span></span>
<span><span class="co">## 9         50 AB_vs_CD  0.027530531</span></span>
<span><span class="co">## 10        50   A_vs_B -0.009356533</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="understanding-the-output-metrics">Understanding the output metrics<a class="anchor" aria-label="anchor" href="#understanding-the-output-metrics"></a>
</h2>
<p><code>contrast_rsa_model</code> can return several metrics. Multiple
metrics can be requested at once and are returned in a named list for
each searchlight location. The main options are:</p>
<div class="section level3">
<h3 id="beta_delta">
<code>beta_delta</code><a class="anchor" aria-label="anchor" href="#beta_delta"></a>
</h3>
<p>The product of the RSA regression coefficient
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>q</mi></msub><annotation encoding="application/x-tex">\beta_q</annotation></semantics></math>)
and the voxel’s projection onto each contrast
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>q</mi><mo>,</mo><mi>v</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{q,v}</annotation></semantics></math>).
This signed quantity indicates how strongly the voxel supports the
representational difference captured by each contrast. Positive values
mean the voxel pattern aligns with the predicted direction; negative
values indicate the opposite.</p>
</div>
<div class="section level3">
<h3 id="beta_only">
<code>beta_only</code><a class="anchor" aria-label="anchor" href="#beta_only"></a>
</h3>
<p>Only the regression coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>q</mi></msub><annotation encoding="application/x-tex">\beta_q</annotation></semantics></math>.
Useful when you want a map of how much each contrast explains the local
RDM independent of the voxel projections.</p>
</div>
<div class="section level3">
<h3 id="delta_only">
<code>delta_only</code><a class="anchor" aria-label="anchor" href="#delta_only"></a>
</h3>
<p>The projection values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>q</mi><mo>,</mo><mi>v</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{q,v}</annotation></semantics></math>
by themselves. These show the raw contribution of each voxel to the
contrast space before weighting by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>q</mi></msub><annotation encoding="application/x-tex">\beta_q</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="recon_score">
<code>recon_score</code><a class="anchor" aria-label="anchor" href="#recon_score"></a>
</h3>
<p>A single value (per voxel) measuring how well the voxel’s
beta-weighted pattern reconstructs the empirical RDM of the searchlight.
Higher values indicate the voxel is individually informative about the
multi-contrast representational structure.</p>
</div>
<div class="section level3">
<h3 id="beta_delta_norm">
<code>beta_delta_norm</code><a class="anchor" aria-label="anchor" href="#beta_delta_norm"></a>
</h3>
<p>Like <code>beta_delta</code> but using an L2-normalized contribution
vector. This emphasizes the direction of the contribution rather than
its magnitude and requires <code>normalize_delta = TRUE</code> when
constructing the model.</p>
</div>
<div class="section level3">
<h3 id="beta_delta_reliable">
<code>beta_delta_reliable</code><a class="anchor" aria-label="anchor" href="#beta_delta_reliable"></a>
</h3>
<p>Reliability-weighted contributions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>q</mi><mo>,</mo><mi>v</mi></mrow></msub><msub><mi>β</mi><mi>q</mi></msub><msub><mi>Δ</mi><mrow><mi>q</mi><mo>,</mo><mi>v</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\rho_{q,v} \beta_q \Delta_{q,v}</annotation></semantics></math>.
The weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mrow><mi>q</mi><mo>,</mo><mi>v</mi></mrow></msub><annotation encoding="application/x-tex">\rho_{q,v}</annotation></semantics></math>
reflect how stable each voxel’s contributions are across
cross-validation folds, highlighting consistent effects.</p>
</div>
<div class="section level3">
<h3 id="composite">
<code>composite</code><a class="anchor" aria-label="anchor" href="#composite"></a>
</h3>
<p>The sum of beta-weighted, normalized contributions across contrasts
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∑</mo><mi>q</mi></msub><msub><mi>β</mi><mi>q</mi></msub><msub><mover><mi>Δ</mi><mo accent="true">̃</mo></mover><mrow><mi>q</mi><mo>,</mo><mi>v</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sum_q \beta_q \tilde{\Delta}_{q,v}</annotation></semantics></math>).
This “net pull” summarizes whether a voxel overall favors the positive
or negative side of the contrast space. Interpretation is easiest when
the contrast matrix is orthonormal.</p>
<p>These metrics allow flexible interrogation of how each voxel or
region participates in the specified representational contrasts.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p><code>contrast_rsa_model</code> extends standard RSA by decomposing
voxel contributions along user-defined contrasts. By selecting
appropriate output metrics you can visualize beta weights, raw
contributions, reliability-weighted effects, or overall reconstruction
quality. The combination of metrics provides a rich picture of the
representational landscape revealed by the analysis.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
