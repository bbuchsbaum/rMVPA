<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced RSA Methods: Feature-Based and Vector-Based Approaches • rMVPA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced RSA Methods: Feature-Based and Vector-Based Approaches">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rMVPA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Advanced RSA Methods: Feature-Based and Vector-Based Approaches</h1>
                        <h4 data-toc-skip class="author">Bradley
Buchsbaum</h4>
            
            <h4 data-toc-skip class="date">2025-03-20</h4>
      

      <div class="d-none name"><code>Advanced_RSA.Rmd</code></div>
    </div>

    
    
<pre><code><span><span class="co">## Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</span></span></code></pre>
<pre><code><span><span class="co">## Warning: 'rgl.init' failed, will use the null device.</span></span>
<span><span class="co">## See '?rgl.useNULL' for ways to avoid this warning.</span></span></code></pre>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>While standard Representational Similarity Analysis (RSA) compares
neural patterns with model-based similarity structures, there are cases
where more specialized approaches are needed. The <code>rMVPA</code>
package provides two advanced RSA methods:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Feature-Based RSA</strong>: Projects neural patterns into a
predefined feature space</li>
<li>
<strong>Vector-Based RSA</strong>: Directly compares vectorized
distance matrices</li>
</ol>
<p>This vignette explains when and why to use these specialized
approaches instead of standard RSA.</p>
</div>
<div class="section level2">
<h2 id="feature-based-rsa">Feature-Based RSA<a class="anchor" aria-label="anchor" href="#feature-based-rsa"></a>
</h2>
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>Feature-Based RSA is designed for cases where:</p>
<ol style="list-style-type: decimal">
<li>You have a rich feature space describing your stimuli</li>
<li>You want to directly map neural patterns to these features</li>
<li>You’re interested in reconstructing stimulus features from neural
patterns</li>
</ol>
<p>Unlike standard RSA which compares similarity matrices, Feature-Based
RSA attempts to find a mapping between neural patterns and a feature
space.</p>
</div>
<div class="section level3">
<h3 id="key-differences-from-standard-rsa">Key Differences from Standard RSA<a class="anchor" aria-label="anchor" href="#key-differences-from-standard-rsa"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Direct Feature Mapping</strong>:
<ul>
<li>Standard RSA: Compares similarity structures</li>
<li>Feature RSA: Maps neural patterns to feature dimensions</li>
</ul>
</li>
<li>
<strong>Output</strong>:
<ul>
<li>Standard RSA: Correlation/regression coefficients between RDMs</li>
<li>Feature RSA: Predicted feature values for each stimulus</li>
</ul>
</li>
<li>
<strong>Use Cases</strong>:
<ul>
<li>Standard RSA: Testing theoretical models of representation</li>
<li>Feature RSA: Reconstructing stimulus features from brain
activity</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="implementation-example">Implementation Example<a class="anchor" aria-label="anchor" href="#implementation-example"></a>
</h3>
<p>Let’s walk through a complete example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate a synthetic dataset with dimensions 6x6x6, 50 observations, divided into 4 blocks</span></span>
<span><span class="co"># This ensures that the number of trials matches the number of stimuli used below</span></span>
<span><span class="va">data_out</span> <span class="op">&lt;-</span> <span class="fu">rMVPA</span><span class="fu">::</span><span class="fu"><a href="../reference/gen_sample_dataset.html">gen_sample_dataset</a></span><span class="op">(</span>D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">50</span>, blocks <span class="op">=</span> <span class="fl">4</span>, nlevels <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data_out</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">█▀▀ MVPA Dataset ▀▀█</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">├─ Training Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">│  ├─ Dimensions: </span> <span style="color: #00BB00;">6 × 6 × 6 × </span><span style="color: #0000BB; font-style: italic;">50</span><span style="color: #00BB00;"> observations</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">│  └─ Type: </span> DenseNeuroVec </span></span>
<span><span class="co">## <span style="color: #BBBB00;">├─ Test Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">│  └─ </span> <span style="color: #BB0000;">None</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">└─ Mask Information</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   ├─ Areas: </span> 1 : <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   └─ Active voxels/vertices: </span> <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $design</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">█▀▀ MVPA Design ▀▀█</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">├─ Training Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">│  ├─ Observations: </span> <span style="color: #00BB00;">50</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">│  ├─ Response Type: </span> Factor</span></span>
<span><span class="co">## <span style="color: #BBBBBB;">│  ├─ Levels: </span> <span style="color: #0000BB;">a, b</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">│  └─ Class Distribution: </span> <span style="color: #00BB00;">a: 25, b: 25</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">├─ Test Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">│  └─ </span> <span style="color: #BB0000;">None</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">└─ Structure</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   ├─ Blocking: </span> Present</span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   ├─ Number of Blocks: </span> <span style="color: #00BB00;">4</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   ├─ Mean Block Size: </span> <span style="color: #00BB00;">12</span> <span style="color: #BBBBBB; font-style: italic;"> (SD: </span> <span style="color: #00BB00;">0.58</span> <span style="color: #BBBBBB; font-style: italic;">)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   └─ Split Groups: </span> <span style="color: #BB0000;">None</span></span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate synthetic feature space (e.g., visual features of stimuli)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_stimuli</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">n_features</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># Create feature matrix (stimuli × features)</span></span>
<span><span class="va">feature_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_stimuli</span> <span class="op">*</span> <span class="va">n_features</span><span class="op">)</span>, <span class="va">n_stimuli</span>, <span class="va">n_features</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">feature_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"feature_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_features</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create stimulus labels</span></span>
<span><span class="va">stim_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"stim_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_stimuli</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create feature RSA design</span></span>
<span><span class="va">feature_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/feature_rsa_design.html">feature_rsa_design</a></span><span class="op">(</span></span>
<span>  F <span class="op">=</span> <span class="va">feature_matrix</span>,  <span class="co"># Direct feature matrix</span></span>
<span>  labels <span class="op">=</span> <span class="va">stim_labels</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create MVPA dataset from the generated data</span></span>
<span><span class="va">dset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvpa_dataset.html">mvpa_dataset</a></span><span class="op">(</span><span class="va">data_out</span><span class="op">$</span><span class="va">dataset</span><span class="op">$</span><span class="va">train_data</span>, mask <span class="op">=</span> <span class="va">data_out</span><span class="op">$</span><span class="va">dataset</span><span class="op">$</span><span class="va">mask</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create cross-validation structure using the block information</span></span>
<span><span class="va">crossval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_validation.html">blocked_cross_validation</a></span><span class="op">(</span><span class="va">data_out</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">block_var</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create feature RSA model</span></span>
<span><span class="va">feature_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/feature_rsa_model.html">feature_rsa_model</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="va">dset</span>,</span>
<span>  design <span class="op">=</span> <span class="va">feature_design</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"scca"</span>,  <span class="co"># Sparse Canonical Correlation Analysis</span></span>
<span>  crossval <span class="op">=</span> <span class="va">crossval</span>  <span class="co"># Add cross-validation</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create proper region mask from the dataset's mask</span></span>
<span><span class="va">mask_vol</span> <span class="op">&lt;-</span> <span class="va">data_out</span><span class="op">$</span><span class="va">dataset</span><span class="op">$</span><span class="va">mask</span></span>
<span><span class="va">nvox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mask_vol</span><span class="op">)</span></span>
<span><span class="va">region_mask</span> <span class="op">&lt;-</span> <span class="fu">neuroim2</span><span class="fu">::</span><span class="fu"><a href="https://bbuchsbaum.github.io/neuroim2/reference/NeuroVol.html" class="external-link">NeuroVol</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, size <span class="op">=</span> <span class="va">nvox</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,  <span class="co"># 3 regions</span></span>
<span>  <span class="fu">space</span><span class="op">(</span><span class="va">mask_vol</span><span class="op">)</span>,</span>
<span>  indices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">mask_vol</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run regional analysis</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_regional.html">run_regional</a></span><span class="op">(</span><span class="va">feature_model</span>, <span class="va">region_mask</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in value[[3L]](cond) : </span></span>
<span><span class="co">##   SCCA error: there is no package called 'whitening'</span></span>
<span><span class="co">## Error in value[[3L]](cond) : </span></span>
<span><span class="co">##   SCCA error: there is no package called 'whitening'</span></span>
<span><span class="co">## Error in value[[3L]](cond) : </span></span>
<span><span class="co">##   SCCA error: there is no package called 'whitening'</span></span>
<span><span class="co">## INFO [2025-03-20 21:30:40] </span></span>
<span><span class="co">## ✨ MVPA Iteration Complete</span></span>
<span><span class="co">## ├─ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## ├─ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## └─ Skipped: <span style="color: #BBBB00;">0</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: Performance matrix is empty or invalid. Returning empty results.</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">performance_table</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 1</span></span></span>
<span><span class="co">##   roinum</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      3</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="available-methods">Available Methods<a class="anchor" aria-label="anchor" href="#available-methods"></a>
</h3>
<p>Feature-Based RSA supports multiple analysis methods:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Sparse Canonical Correlation Analysis (SCCA)</strong>:
<ul>
<li>Finds canonical correlations between neural patterns and
features</li>
<li>Useful when features may be correlated</li>
</ul>
</li>
<li>
<strong>Partial Least Squares (PLS)</strong>:
<ul>
<li>Projects data to maximize covariance with features</li>
<li>Good for high-dimensional feature spaces</li>
</ul>
</li>
<li>
<strong>PCA Regression</strong>:
<ul>
<li>Reduces neural patterns via PCA then predicts features</li>
<li>Useful for very high-dimensional neural data</li>
</ul>
</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different methods</span></span>
<span><span class="va">methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scca"</span>, <span class="st">"pca"</span><span class="op">)</span> <span class="co">## pls is not implemented yet</span></span>
<span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">methods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">method</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/feature_rsa_model.html">feature_rsa_model</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">dset</span>,</span>
<span>    design <span class="op">=</span> <span class="va">feature_design</span>,</span>
<span>    method <span class="op">=</span> <span class="va">method</span>,</span>
<span>    crossval <span class="op">=</span> <span class="va">crossval</span>  <span class="co"># Add cross-validation</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/run_regional.html">run_regional</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">region_mask</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in value[[3L]](cond) : </span></span>
<span><span class="co">##   SCCA error: there is no package called 'whitening'</span></span>
<span><span class="co">## Error in value[[3L]](cond) : </span></span>
<span><span class="co">##   SCCA error: there is no package called 'whitening'</span></span>
<span><span class="co">## Error in value[[3L]](cond) : </span></span>
<span><span class="co">##   SCCA error: there is no package called 'whitening'</span></span>
<span><span class="co">## INFO [2025-03-20 21:30:41] </span></span>
<span><span class="co">## ✨ MVPA Iteration Complete</span></span>
<span><span class="co">## ├─ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## ├─ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## └─ Skipped: <span style="color: #BBBB00;">0</span></span></span></code></pre>
<pre><code><span><span class="co">## Warning: Performance matrix is empty or invalid. Returning empty results.</span></span></code></pre>
<pre><code><span><span class="co">## INFO [2025-03-20 21:30:42] </span></span>
<span><span class="co">## ✨ MVPA Iteration Complete</span></span>
<span><span class="co">## ├─ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## ├─ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## └─ Skipped: <span style="color: #BBBB00;">0</span></span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare performance</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">methods</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nMethod:"</span>, <span class="va">methods</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">performance_table</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Method: scca </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 1</span></span></span>
<span><span class="co">##   roinum</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Method: pca </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">##   roinum mean_correlation spatial_specificity voxel_correlation   mse r_squared</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      1          -<span style="color: #BB0000;">0.065</span><span style="color: #BB0000; text-decoration: underline;">2</span>             -<span style="color: #BB0000;">0.065</span><span style="color: #BB0000; text-decoration: underline;">6</span>          -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">15</span>  1.13    -<span style="color: #BB0000;">0.183</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      2          -<span style="color: #BB0000;">0.109</span>              -<span style="color: #BB0000;">0.112</span>           -<span style="color: #BB0000;">0.059</span><span style="color: #BB0000; text-decoration: underline;">3</span>   1.18    -<span style="color: #BB0000;">0.215</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      3          -<span style="color: #BB0000;">0.069</span><span style="color: #BB0000; text-decoration: underline;">3</span>             -<span style="color: #BB0000;">0.068</span><span style="color: #BB0000; text-decoration: underline;">7</span>          -<span style="color: #BB0000;">0.001</span><span style="color: #BB0000; text-decoration: underline;">89</span>  1.18    -<span style="color: #BB0000;">0.184</span></span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="vector-based-rsa">Vector-Based RSA<a class="anchor" aria-label="anchor" href="#vector-based-rsa"></a>
</h2>
<div class="section level3">
<h3 id="overview-1">Overview<a class="anchor" aria-label="anchor" href="#overview-1"></a>
</h3>
<p>Vector-Based RSA is designed for cases where:</p>
<ol style="list-style-type: decimal">
<li>You have pre-computed distance matrices</li>
<li>You want to compare across-block distances only</li>
<li>You need efficient computation for large datasets</li>
</ol>
<p>Unlike standard RSA which works with full similarity matrices,
Vector-Based RSA operates on vectorized distance matrices and can
efficiently handle block structure.</p>
</div>
<div class="section level3">
<h3 id="key-differences-from-standard-rsa-1">Key Differences from Standard RSA<a class="anchor" aria-label="anchor" href="#key-differences-from-standard-rsa-1"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Computation</strong>:
<ul>
<li>Standard RSA: Works with full similarity matrices</li>
<li>Vector RSA: Works with vectorized distances</li>
</ul>
</li>
<li>
<strong>Block Handling</strong>:
<ul>
<li>Standard RSA: Manual block exclusion</li>
<li>Vector RSA: Built-in efficient block handling</li>
</ul>
</li>
<li>
<strong>Memory Usage</strong>:
<ul>
<li>Standard RSA: Stores full matrices</li>
<li>Vector RSA: Stores only necessary comparisons</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="implementation-example-1">Implementation Example<a class="anchor" aria-label="anchor" href="#implementation-example-1"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create distance matrix for stimuli</span></span>
<span><span class="va">stim_distances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="va">feature_matrix</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">stim_distances</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">stim_labels</span></span>
<span></span>
<span><span class="co"># Create block structure (e.g., runs)</span></span>
<span><span class="va">blocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, length.out <span class="op">=</span> <span class="va">n_stimuli</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create vector RSA design</span></span>
<span><span class="va">vector_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vector_rsa_design.html">vector_rsa_design</a></span><span class="op">(</span></span>
<span>    D <span class="op">=</span> <span class="va">stim_distances</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">stim_labels</span>,</span>
<span>    block_var <span class="op">=</span> <span class="va">blocks</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create vector RSA model</span></span>
<span><span class="va">vector_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vector_rsa_model.html">vector_rsa_model</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="va">dset</span>,</span>
<span>  design <span class="op">=</span> <span class="va">vector_design</span>,</span>
<span>  distfun <span class="op">=</span> <span class="fu"><a href="../reference/distance-constructors.html">cordist</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># Correlation distance</span></span>
<span>  rsa_simfun <span class="op">=</span> <span class="st">"pearson"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run analysis</span></span>
<span><span class="va">results_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_regional.html">run_regional</a></span><span class="op">(</span><span class="va">vector_model</span>, <span class="va">region_mask</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## INFO [2025-03-20 21:30:43] </span></span>
<span><span class="co">## ✨ MVPA Iteration Complete</span></span>
<span><span class="co">## ├─ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## ├─ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## └─ Skipped: <span style="color: #BBBB00;">0</span></span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results_vector</span><span class="op">$</span><span class="va">performance_table</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 0 × 0</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="efficient-block-handling">Efficient Block Handling<a class="anchor" aria-label="anchor" href="#efficient-block-handling"></a>
</h3>
<p>Vector-Based RSA automatically handles block structure:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare with different block structures</span></span>
<span><span class="va">block_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">results_blocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">block_sizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">blocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n_stimuli</span><span class="op">/</span><span class="va">size</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">size</span><span class="op">)</span></span>
<span>  <span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vector_rsa_design.html">vector_rsa_design</a></span><span class="op">(</span></span>
<span>    D <span class="op">=</span> <span class="va">stim_distances</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">stim_labels</span>,</span>
<span>    block_var <span class="op">=</span> <span class="va">blocks</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vector_rsa_model.html">vector_rsa_model</a></span><span class="op">(</span></span>
<span>    dataset <span class="op">=</span> <span class="va">dset</span>,</span>
<span>    design <span class="op">=</span> <span class="va">design</span>,</span>
<span>    distfun <span class="op">=</span> <span class="fu"><a href="../reference/distance-constructors.html">cordist</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/run_regional.html">run_regional</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">region_mask</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## INFO [2025-03-20 21:30:43] </span></span>
<span><span class="co">## ✨ MVPA Iteration Complete</span></span>
<span><span class="co">## ├─ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## ├─ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## └─ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-03-20 21:30:44] </span></span>
<span><span class="co">## ✨ MVPA Iteration Complete</span></span>
<span><span class="co">## ├─ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## ├─ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## └─ Skipped: <span style="color: #BBBB00;">0</span></span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare results</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">block_sizes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nBlock size:"</span>, <span class="va">block_sizes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results_blocks</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">performance_table</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Block size: 5 </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 0 × 0</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Block size: 10 </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 0 × 0</span></span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="when-to-use-each-method">When to Use Each Method<a class="anchor" aria-label="anchor" href="#when-to-use-each-method"></a>
</h2>
<div class="section level3">
<h3 id="feature-based-rsa-1">Feature-Based RSA<a class="anchor" aria-label="anchor" href="#feature-based-rsa-1"></a>
</h3>
<p>Feature-Based RSA is most appropriate when working with a
well-defined feature space where the dimensions have meaningful
interpretations. This approach excels at reconstructing and predicting
specific stimulus features from neural activity patterns. Common
applications include predicting visual features from visual cortex
responses, reconstructing semantic dimensions from language area
activity, and mapping motion parameters from MT/V5 activation
patterns.</p>
</div>
<div class="section level3">
<h3 id="vector-based-rsa-1">Vector-Based RSA<a class="anchor" aria-label="anchor" href="#vector-based-rsa-1"></a>
</h3>
<p>Vector-Based RSA is ideal for analyzing large datasets with
pre-computed distance matrices. It handles memory efficiently and
provides sophisticated block handling capabilities. This makes it
particularly valuable when comparing across multiple experimental runs,
working with high-resolution fMRI data, or analyzing large-scale
similarity structures.</p>
</div>
<div class="section level3">
<h3 id="standard-rsa">Standard RSA<a class="anchor" aria-label="anchor" href="#standard-rsa"></a>
</h3>
<p>Stick with standard RSA when: - You’re testing theoretical models -
You want to compare similarity structures - Block structure isn’t
critical - Memory usage isn’t a concern</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The <code>rMVPA</code> package provides three complementary RSA
approaches:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Standard RSA</strong>: General-purpose similarity
analysis</li>
<li>
<strong>Feature-Based RSA</strong>: Direct feature mapping and
reconstruction</li>
<li>
<strong>Vector-Based RSA</strong>: Efficient similarity comparison
with block handling</li>
</ol>
<p>Your choice of RSA method should align with your research goals,
match your data’s structure, fit within computational constraints, and
reflect whether you’re analyzing feature spaces or similarity
patterns.</p>
<p>For implementation details, refer to: -
<code>feature_rsa_model.R</code> - <code>vector_rsa_model.R</code> -
<code>rsa_model.R</code></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
