<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Searchlight Analysis â€¢ rMVPA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Searchlight Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rMVPA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Searchlight Analysis</h1>
                        <h4 data-toc-skip class="author">Bradley
Buchsbaum</h4>
            
            <h4 data-toc-skip class="date">2025-09-28</h4>
      

      <div class="d-none name"><code>Searchlight_Analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="searchlight-analysis">Searchlight Analysis<a class="anchor" aria-label="anchor" href="#searchlight-analysis"></a>
</h2>
<pre><code><span><span class="co">## Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</span></span></code></pre>
<pre><code><span><span class="co">## Warning: 'rgl.init' failed, will use the null device.</span></span>
<span><span class="co">## See '?rgl.useNULL' for ways to avoid this warning.</span></span></code></pre>
<div class="section level3">
<h3 id="simulated-data">Simulated data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h3>
<p>We first create a small volumetric dataset for demonstration. The
call below generates a 4D image with 6Ã—6Ã—6 spatial voxels and 80
observations along the time dimension. Observations are grouped into 4
blocks (20 trials each), and the response factor <code>y</code> has two
levels. The return value contains both the data
(<code>mvpa_dataset</code>) and the design
(<code>mvpa_design</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_sample_dataset.html">gen_sample_dataset</a></span><span class="op">(</span>D<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span>, nobs <span class="op">=</span> <span class="fl">80</span>, blocks<span class="op">=</span><span class="fl">4</span>, nlevels<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $dataset</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ MVPA Dataset â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Training Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Dimensions: </span> <span style="color: #00BB00;">6 Ã— 6 Ã— 6 Ã— </span><span style="color: #0000BB; font-style: italic;">80</span><span style="color: #00BB00;"> observations</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Type: </span> DenseNeuroVec </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Test Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ </span> <span style="color: #BB0000;">None</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Mask Information</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Areas: </span> 1 : <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â””â”€ Active voxels/vertices: </span> <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $design</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ MVPA Design â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Training Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Observations: </span> <span style="color: #00BB00;">80</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Response Type: </span> Factor</span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Levels: </span> <span style="color: #0000BB;">a, b</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Class Distribution: </span> <span style="color: #00BB00;">a: 40, b: 40</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Test Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ </span> <span style="color: #BB0000;">None</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Structure</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Blocking: </span> Present</span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Number of Blocks: </span> <span style="color: #00BB00;">4</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Mean Block Size: </span> <span style="color: #00BB00;">20</span> <span style="color: #BBBBBB; font-style: italic;"> (SD: </span> <span style="color: #00BB00;">0</span> <span style="color: #BBBBBB; font-style: italic;">)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â””â”€ Split Groups: </span> <span style="color: #BB0000;">None</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="crossvalidation">Crossâ€‘validation<a class="anchor" aria-label="anchor" href="#crossvalidation"></a>
</h3>
<p>Because trials are organized into runs (blocks), we use a blocked
crossâ€‘validation scheme: train on <code>kâˆ’1</code> blocks and test on
the heldâ€‘out block. This leaveâ€‘oneâ€‘groupâ€‘out strategy respects temporal
correlations within runs and yields a more realistic estimate of
generalization.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">block</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">block_var</span></span>
<span><span class="va">crossval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_validation.html">blocked_cross_validation</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span></span>
<span><span class="va">crossval</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ Blocked Cross-Validation â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Dataset Information</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Observations: </span> <span style="color: #00BB00;">80</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Number of Folds: </span> <span style="color: #00BB00;">4</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Block Information</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Total Blocks: </span> <span style="color: #00BB00;">4</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Mean Block Size: </span> <span style="color: #00BB00;">20</span> <span style="color: #0000BB; font-style: italic;"> (SD: </span> <span style="color: #00BB00;">0</span> <span style="color: #0000BB; font-style: italic;">)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â””â”€ Block Sizes: </span> <span style="color: #00BB00;">1: 20, 2: 20, 3: 20, 4: 20</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="model-specification">Model specification<a class="anchor" aria-label="anchor" href="#model-specification"></a>
</h3>
<p>We use the shrinkage discriminant analysis model
(<code>sda_notune</code>), which estimates its shrinkage parameter from
the training folds. See the <a href="https://cran.r-project.org/web/packages/sda/index.html" class="external-link">sda
package</a> for details.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sda_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_model.html">load_model</a></span><span class="op">(</span><span class="st">"sda_notune"</span><span class="op">)</span> </span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvpa_model.html">mvpa_model</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">sda_model</span>, dataset<span class="op">=</span><span class="va">dataset</span><span class="op">$</span><span class="va">dataset</span>, design<span class="op">=</span><span class="va">dataset</span><span class="op">$</span><span class="va">design</span>, crossval<span class="op">=</span><span class="va">crossval</span><span class="op">)</span></span>
<span><span class="va">model</span></span></code></pre></div>
<pre><code><span><span class="co">## mvpa_model object. </span></span>
<span><span class="co">## model:  sda_notune </span></span>
<span><span class="co">## model type:  classification </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ Blocked Cross-Validation â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Dataset Information</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Observations: </span> <span style="color: #00BB00;">80</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Number of Folds: </span> <span style="color: #00BB00;">4</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Block Information</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Total Blocks: </span> <span style="color: #00BB00;">4</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Mean Block Size: </span> <span style="color: #00BB00;">20</span> <span style="color: #0000BB; font-style: italic;"> (SD: </span> <span style="color: #00BB00;">0</span> <span style="color: #0000BB; font-style: italic;">)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â””â”€ Block Sizes: </span> <span style="color: #00BB00;">1: 20, 2: 20, 3: 20, 4: 20</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ MVPA Dataset â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Training Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Dimensions: </span> <span style="color: #00BB00;">6 Ã— 6 Ã— 6 Ã— </span><span style="color: #0000BB; font-style: italic;">80</span><span style="color: #00BB00;"> observations</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Type: </span> DenseNeuroVec </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Test Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ </span> <span style="color: #BB0000;">None</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Mask Information</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Areas: </span> 1 : <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â””â”€ Active voxels/vertices: </span> <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ MVPA Design â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Training Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Observations: </span> <span style="color: #00BB00;">80</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Response Type: </span> Factor</span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Levels: </span> <span style="color: #0000BB;">a, b</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Class Distribution: </span> <span style="color: #00BB00;">a: 40, b: 40</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Test Data</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ </span> <span style="color: #BB0000;">None</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Structure</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Blocking: </span> Present</span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Number of Blocks: </span> <span style="color: #00BB00;">4</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ Mean Block Size: </span> <span style="color: #00BB00;">20</span> <span style="color: #BBBBBB; font-style: italic;"> (SD: </span> <span style="color: #00BB00;">0</span> <span style="color: #BBBBBB; font-style: italic;">)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â””â”€ Split Groups: </span> <span style="color: #BB0000;">None</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="standard-searchlight">Standard searchlight<a class="anchor" aria-label="anchor" href="#standard-searchlight"></a>
</h3>
<p><code><a href="../reference/run_searchlight.html">run_searchlight()</a></code> returns image volumes with performance
metrics at each sphere center. For twoâ€‘class problems we report
crossâ€‘validated accuracy and AUC (centered at 0 by subtracting 0.5). The
<code>radius</code> is in millimeters; <code>method = "standard"</code>
evaluates one model per sphere centered on each voxel.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_searchlight.html">run_searchlight</a></span><span class="op">(</span><span class="va">model</span>, radius<span class="op">=</span><span class="fl">4</span>, method<span class="op">=</span><span class="st">"standard"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## INFO [2025-09-28 01:09:48] Running standard searchlight with radius = 4</span></span>
<span><span class="co">## INFO [2025-09-28 01:09:48] creating standard searchlight</span></span>
<span><span class="co">## INFO [2025-09-28 01:09:48] running standard searchlight iterator</span></span>
<span><span class="co">## INFO [2025-09-28 01:09:48] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:09:52] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:09:55] âš¡ Processing batch <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:09:59] âš¡ Processing batch <span style="color: #0000BB;">4</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:03] âš¡ Processing batch <span style="color: #0000BB;">5</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:07] âš¡ Processing batch <span style="color: #0000BB;">6</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:10] âš¡ Processing batch <span style="color: #0000BB;">7</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:14] âš¡ Processing batch <span style="color: #0000BB;">8</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:17] âš¡ Processing batch <span style="color: #0000BB;">9</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:21] âš¡ Processing batch <span style="color: #0000BB;">10</span>/<span style="color: #0000BB;">10</span> (<span style="color: #00BB00;">12</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:24] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">120</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">120</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## WARN [2025-09-28 01:10:24] Observed probabilities map skipped: expected 216 rows but found 80.</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ Searchlight Analysis Results â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Coverage</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Voxels/Vertices in Mask: </span> <span style="color: #00BB00;">216</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Voxels/Vertices with Results: </span> <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Output Maps (Metrics)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ </span> <span style="color: #BB00BB;">Accuracy</span> <span style="color: #BBBBBB;"> (Type: </span> <span style="color: #0000BB;">DenseNeuroVol</span> <span style="color: #BBBBBB;">)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ </span> <span style="color: #BB00BB;">AUC</span> <span style="color: #BBBBBB;"> (Type: </span> <span style="color: #0000BB;">DenseNeuroVol</span> <span style="color: #BBBBBB;">)</span></span></span></code></pre>
<p><img src="Searchlight_Analysis_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="randomized-searchlight">Randomized searchlight<a class="anchor" aria-label="anchor" href="#randomized-searchlight"></a>
</h2>
<p>The randomized variant samples nonâ€‘overlapping spheres and propagates
each sphereâ€™s score to all voxels it covers. Repeating this for
<code>niter</code> exhaustive passes yields, at each voxel, the average
performance across the spheres that included it. This can improve
spatial localization and often reduces computation, since the number of
models scales with <code>nvoxels / radius Ã— niter</code> rather than the
total number of voxels.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_searchlight.html">run_searchlight</a></span><span class="op">(</span><span class="va">model</span>, radius<span class="op">=</span><span class="fl">4</span>, method<span class="op">=</span><span class="st">"randomized"</span>, niter<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## INFO [2025-09-28 01:10:24] Running randomized searchlight with radius = 4 and niter = 8</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:24] ðŸ”„ Starting randomized searchlight analysis:</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:24] â”œâ”€ Radius: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:24] â””â”€ Iterations: <span style="color: #0000BB;">8</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:24] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">8</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:24] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:25] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:26] âš¡ Processing batch <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:27] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:28] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">8</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:28] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:29] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:30] âš¡ Processing batch <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:31] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:31] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">8</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:31] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:32] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:33] âš¡ Processing batch <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:34] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:35] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">4</span>/<span style="color: #0000BB;">8</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:35] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">4</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:36] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">4</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:37] âš¡ Processing batch <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">4</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:38] âš¡ Processing batch <span style="color: #0000BB;">4</span>/<span style="color: #0000BB;">4</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:39] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:39] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">5</span>/<span style="color: #0000BB;">8</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:39] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:40] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:41] âš¡ Processing batch <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:42] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:42] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">6</span>/<span style="color: #0000BB;">8</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:42] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">2</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:43] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">2</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:44] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:45] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">7</span>/<span style="color: #0000BB;">8</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:45] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:46] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:47] âš¡ Processing batch <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:48] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:48] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">8</span>/<span style="color: #0000BB;">8</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:48] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:49] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:50] âš¡ Processing batch <span style="color: #0000BB;">3</span>/<span style="color: #0000BB;">3</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:51] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">3</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:52] </span></span>
<span><span class="co">## âœ¨ Searchlight Analysis Complete</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:52] â”œâ”€ Total Models Fit: <span style="color: #00BB00;">24</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:52] â””â”€ All ROIs processed successfully!</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ Searchlight Analysis Results â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Coverage</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Voxels/Vertices in Mask: </span> <span style="color: #00BB00;">216</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Voxels/Vertices with Results: </span> <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Output Maps (Metrics)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ </span> <span style="color: #BB00BB;">Metric1</span> <span style="color: #BBBBBB;"> (Type: </span> <span style="color: #0000BB;">DenseNeuroVol</span> <span style="color: #BBBBBB;">)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ </span> <span style="color: #BB00BB;">Metric2</span> <span style="color: #BBBBBB;"> (Type: </span> <span style="color: #0000BB;">DenseNeuroVol</span> <span style="color: #BBBBBB;">)</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="using-different-classifiers">Using different classifiers<a class="anchor" aria-label="anchor" href="#using-different-classifiers"></a>
</h2>
<p>Any classifier in the model registry can be used in a searchlight.
You can also register your own with <code><a href="../reference/register_mvpa_model.html">register_mvpa_model()</a></code>.
For example, to run a linear SVM:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_model.html">load_model</a></span><span class="op">(</span><span class="st">"svmLinear"</span><span class="op">)</span> </span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvpa_model.html">mvpa_model</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">svm_model</span>, dataset<span class="op">=</span><span class="va">dataset</span><span class="op">$</span><span class="va">dataset</span>, design<span class="op">=</span><span class="va">dataset</span><span class="op">$</span><span class="va">design</span>, crossval<span class="op">=</span><span class="va">crossval</span><span class="op">)</span></span>
<span><span class="va">result_svm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_searchlight.html">run_searchlight</a></span><span class="op">(</span><span class="va">model</span>, radius<span class="op">=</span><span class="fl">4</span>, method<span class="op">=</span><span class="st">"randomized"</span>, niter<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>For random forests, you can either fix <code>mtry</code> or tune it
over a small grid. Tuning quickly becomes expensive in wholeâ€‘brain
analyses, so <code>sda_notune</code> is often a good default when
compute is limited.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"randomForest"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rf_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_model.html">load_model</a></span><span class="op">(</span><span class="st">"rf"</span><span class="op">)</span></span>
<span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvpa_model.html">mvpa_model</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">rf_model</span>, dataset <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">dataset</span>, design <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">design</span>,</span>
<span>                      crossval <span class="op">=</span> <span class="va">crossval</span>, tune_grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mtry <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">result_rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_searchlight.html">run_searchlight</a></span><span class="op">(</span><span class="va">model</span>, radius <span class="op">=</span> <span class="fl">4</span>, method <span class="op">=</span> <span class="st">"randomized"</span>, niter <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">result_rf</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Package 'randomForest' not installed; skipping RF example."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## INFO [2025-09-28 01:10:52] Running randomized searchlight with radius = 4 and niter = 2</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:52] ðŸ”„ Starting randomized searchlight analysis:</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:52] â”œâ”€ Radius: <span style="color: #0000BB;">4</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:52] â””â”€ Iterations: <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:52] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:52] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">2</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:53] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">2</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:54] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:55] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:55] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">2</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:56] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">2</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:57] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:57] </span></span>
<span><span class="co">## âœ¨ Searchlight Analysis Complete</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:57] â”œâ”€ Total Models Fit: <span style="color: #00BB00;">4</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:57] â””â”€ All ROIs processed successfully!</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ Searchlight Analysis Results â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Coverage</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Voxels/Vertices in Mask: </span> <span style="color: #00BB00;">216</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Voxels/Vertices with Results: </span> <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Output Maps (Metrics)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ </span> <span style="color: #BB00BB;">Metric1</span> <span style="color: #BBBBBB;"> (Type: </span> <span style="color: #0000BB;">DenseNeuroVol</span> <span style="color: #BBBBBB;">)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ </span> <span style="color: #BB00BB;">Metric2</span> <span style="color: #BBBBBB;"> (Type: </span> <span style="color: #0000BB;">DenseNeuroVol</span> <span style="color: #BBBBBB;">)</span></span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"randomForest"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mvpa_model.html">mvpa_model</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">rf_model</span>, dataset <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">dataset</span>, design <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">design</span>,</span>
<span>                       crossval <span class="op">=</span> <span class="va">crossval</span>, tune_grid <span class="op">=</span> <span class="va">grid</span>, tune_reps <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">result_rf_tuned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_searchlight.html">run_searchlight</a></span><span class="op">(</span><span class="va">model2</span>, radius <span class="op">=</span> <span class="fl">6</span>, method <span class="op">=</span> <span class="st">"randomized"</span>, niter <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">result_rf_tuned</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Package 'randomForest' not installed; skipping tuned RF example."</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## INFO [2025-09-28 01:10:57] Running randomized searchlight with radius = 6 and niter = 1</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:57] ðŸ”„ Starting randomized searchlight analysis:</span></span>
<span><span class="co">## INFO [2025-09-28 01:10:57] â”œâ”€ Radius: <span style="color: #0000BB;">6</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:57] â””â”€ Iterations: <span style="color: #0000BB;">1</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:57] </span></span>
<span><span class="co">## ðŸ“Š Iteration <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">1</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:10:57] âš¡ Processing batch <span style="color: #0000BB;">1</span>/<span style="color: #0000BB;">2</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:11:02] âš¡ Processing batch <span style="color: #0000BB;">2</span>/<span style="color: #0000BB;">2</span> (<span style="color: #00BB00;">1</span> ROIs in this batch)</span></span>
<span><span class="co">## INFO [2025-09-28 01:11:03] </span></span>
<span><span class="co">## âœ¨ MVPA Iteration Complete</span></span>
<span><span class="co">## â”œâ”€ Total ROIs: <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## â”œâ”€ Processed: <span style="color: #0000BB;">2</span></span></span>
<span><span class="co">## â””â”€ Skipped: <span style="color: #BBBB00;">0</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:11:04] </span></span>
<span><span class="co">## âœ¨ Searchlight Analysis Complete</span></span>
<span><span class="co">## INFO [2025-09-28 01:11:04] â”œâ”€ Total Models Fit: <span style="color: #00BB00;">2</span></span></span>
<span><span class="co">## INFO [2025-09-28 01:11:04] â””â”€ All ROIs processed successfully!</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  <span style="color: #00BBBB; font-weight: bold;">â–ˆâ–€â–€ Searchlight Analysis Results â–€â–€â–ˆ</span> </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â”œâ”€ Coverage</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â”œâ”€ Voxels/Vertices in Mask: </span> <span style="color: #00BB00;">216</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">â”‚  â””â”€ Voxels/Vertices with Results: </span> <span style="color: #00BB00;">120</span> </span></span>
<span><span class="co">## <span style="color: #BBBB00;">â””â”€ Output Maps (Metrics)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ </span> <span style="color: #BB00BB;">Metric1</span> <span style="color: #BBBBBB;"> (Type: </span> <span style="color: #0000BB;">DenseNeuroVol</span> <span style="color: #BBBBBB;">)</span> </span></span>
<span><span class="co">## <span style="color: #BBBBBB;">   â”œâ”€ </span> <span style="color: #BB00BB;">Metric2</span> <span style="color: #BBBBBB;"> (Type: </span> <span style="color: #0000BB;">DenseNeuroVol</span> <span style="color: #BBBBBB;">)</span></span></span></code></pre>
<!-- ## External Cross-Validation Example -->
<!-- Instead of using internal cross-validation, as we used in the above examples, sometimes one might have a held-out test data that can be used as a validation set. Here we show how to  -->
<!-- ```{r} -->
<!-- # Create training data -->
<!-- train_design <- data.frame(y = rep(letters[1:4], 5), x1 = rnorm(20), x2 = rnorm(20), block = rep(1:4, each = 5)) -->
<!-- # Create test data -->
<!-- test_design <- data.frame(y = sample(letters[1:4], 10, replace=TRUE)) -->
<!-- # Create an MVPA design object with external cross-validation -->
<!-- design <- mvpa_design(train_design, ~ y, block_var = ~ block, test_design = test_design, y_test = ~ y) -->
<!-- # Display the MVPA design object -->
<!-- print(design) -->
<!-- # Create a new dataset for external cross-validation -->
<!-- dataset_ext <- list(dataset = dataset$dataset, design = design) -->
<!-- # Construct an `mvpa_model` object with a Shrinkage Discriminant Analysis classifier (`sda_notune`) -->
<!-- sda_model_ext <- load_model("sda_notune") -->
<!-- model_ext <- mvpa_model(model = sda_model_ext, dataset = dataset_ext$dataset, design = dataset_ext$design) -->
<!-- # Run a randomized searchlight analysis using external cross-validation -->
<!-- result_ext <- run_searchlight(model_ext, radius = 4, method = "randomized", niter = 8) -->
<!-- # Display the results -->
<!-- print(result_ext) -->
<!-- # Plot a histogram of AUC values -->
<!-- hist(result_ext$AUC) -->
<!-- ``` -->
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
