<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extending the MVPA Framework: Creating a New Analysis Type — new-analysis-overview • rMVPA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extending the MVPA Framework: Creating a New Analysis Type — new-analysis-overview"><meta name="description" content="This documentation describes how to implement a **new MVPA analysis type** within the package.
The MVPA framework here is designed to be extensible via S3 generics. By providing the necessary
methods and classes, you can integrate custom analyses (beyond standard classification, regression, or RSA)."><meta property="og:description" content="This documentation describes how to implement a **new MVPA analysis type** within the package.
The MVPA framework here is designed to be extensible via S3 generics. By providing the necessary
methods and classes, you can integrate custom analyses (beyond standard classification, regression, or RSA)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rMVPA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extending the MVPA Framework: Creating a New Analysis Type</h1>

      <div class="d-none name"><code>new-analysis-overview.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This documentation describes how to implement a **new MVPA analysis type** within the package.
The MVPA framework here is designed to be extensible via S3 generics. By providing the necessary
methods and classes, you can integrate custom analyses (beyond standard classification, regression, or RSA).</p>
    </div>


    <div class="section level2">
    <h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>


<p>1. **Define a Model Specification**
   - Create an S3 class inheriting from <code>model_spec</code>, e.g. <code>"myanalysis_model"</code>.
   - This class should hold all the **parameters** or **configuration** needed for your analysis
     (e.g., hyperparameters, references, design objects).
   - Construct it using a function like <code>create_model_spec("myanalysis_model", ...)</code>.</p>
<p>2. **Implement Required Generics**
   - <strong><code>train_model.myanalysis_model(obj, train_dat, ...)</code>:</strong>
     Defines how to <em>"train"</em> or <em>execute</em> your analysis on a subset of data
     (e.g., ROI voxel intensities).
     - This might involve fitting a specialized model, computing a metric, or doing an
       unsupervised transform.
     - Return a structured object (often a named list or model fit) that can be further
       handled by the framework.
   - <strong><code>process_roi.myanalysis_model(mod_spec, roi, rnum, ...)</code> (Optional):</strong>
     If you need custom <em>per-ROI</em> logic beyond the default pipeline, implement a
     <code>process_roi</code> method for your class. This method is called automatically by
     <code>run_regional(...)</code> for each region.
     - By default, the framework calls <code>train_model</code> on the ROI's data, but if you
       want to skip or alter that flow, provide a custom <code>process_roi</code> method.
   - (Optional) <strong><code>predict_model.myanalysis_model(...)</code></strong> or <strong><code>evaluate_model.myanalysis_model(...)</code></strong>:
     If your analysis involves a separate test step or specialized evaluation, you can
     define these S3 methods.
   - (Optional) <strong><code>run_future.myanalysis_model(...)</code></strong>, <strong><code>merge_results.myanalysis_model(...)</code></strong>, etc.:
     If you need custom behavior for parallelization or merging partial results, override
     these generics as well.</p>
<p>3. **Use `run_regional()` or `run_searchlight()`**
   - Once your new model class is defined, you can pass an object of that class to
     <code>run_regional(...)</code> or <code>run_searchlight(...)</code> just like a built-in analysis.
   - The framework automatically dispatches calls to your <code>train_model.myanalysis_model</code>
     (and optionally your <code>process_roi.myanalysis_model</code>), returning a result object
     consistent with other MVPA analyses.</p>
    </div>
    <div class="section level2">
    <h2 id="why-these-pieces-are-needed">Why These Pieces Are Needed<a class="anchor" aria-label="anchor" href="#why-these-pieces-are-needed"></a></h2>


<p>- **Model Specification**: Provides the blueprint for how the pipeline should handle your analysis
  (what data you need, how you store intermediate results, etc.).
- **Train Model Generic**: Tells the pipeline what to <em>do</em> with each chunk of data
  (ROI subset, searchlight voxel set, cross-validation fold).
  This is the core of your analysis.
- **<code>process_roi</code>**: If your analysis requires more complex per-region logic than the default
  pipeline (e.g., skipping certain steps, altering the data structure), implementing
  <code>process_roi.myanalysis_model</code> gives you full control.</p>
    </div>
    <div class="section level2">
    <h2 id="example-code-skeleton">Example Code Skeleton<a class="anchor" aria-label="anchor" href="#example-code-skeleton"></a></h2>


<div class="sourceCode"><pre><code><span></span>
<span><span class="co"># Minimal template for a new analysis model</span></span>
<span></span>
<span><span class="va">myanalysis_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataset</span>, <span class="va">design</span>, <span class="va">param1</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">param2</span><span class="op">=</span><span class="fl">5</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create an object of class "myanalysis_model"</span></span>
<span>  <span class="fu">create_model_spec</span><span class="op">(</span></span>
<span>    <span class="st">"myanalysis_model"</span>,</span>
<span>    dataset  <span class="op">=</span> <span class="va">dataset</span>,</span>
<span>    design   <span class="op">=</span> <span class="va">design</span>,</span>
<span>    param1   <span class="op">=</span> <span class="va">param1</span>,</span>
<span>    param2   <span class="op">=</span> <span class="va">param2</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># S3 method to "train" your analysis</span></span>
<span><span class="va">train_model.myanalysis_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">obj</span>, <span class="va">train_dat</span>, <span class="va">y</span>, <span class="va">indices</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># train_dat = subset of voxel intensities or features</span></span>
<span>  <span class="co"># y = optional labels/response if relevant</span></span>
<span>  <span class="co"># indices = location info</span></span>
<span></span>
<span>  <span class="co"># 1) Do your computations (model fitting, metrics, transforms, etc.)</span></span>
<span>  <span class="va">fit_object</span> <span class="op">&lt;-</span> <span class="fu">your_method</span><span class="op">(</span><span class="va">train_dat</span>, some_params<span class="op">=</span><span class="va">obj</span><span class="op">$</span><span class="va">param1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># 2) Return a structure. The pipeline may store or evaluate it further.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    fit <span class="op">=</span> <span class="va">fit_object</span>,</span>
<span>    <span class="co"># any other stuff you want to keep</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Optional custom ROI processor</span></span>
<span><span class="va">process_roi.myanalysis_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mod_spec</span>, <span class="va">roi</span>, <span class="va">rnum</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># If you want to skip or augment the default cross-validation / train_model approach</span></span>
<span>  <span class="co"># in run_regional, define your logic here.</span></span>
<span>  <span class="co"># Otherwise, the default calls train_model(...) on the region's data.</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># You can now call:</span></span>
<span><span class="co"># new_model &lt;- myanalysis_model(dataset, design, param1="xyz")</span></span>
<span><span class="co"># results_regional &lt;- run_regional(new_model, region_mask)</span></span>
<span><span class="co"># results_searchlight &lt;- run_searchlight(new_model, radius=8, method="standard")</span></span></code></pre></div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

