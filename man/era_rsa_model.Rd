% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/era_rsa_model.R
\name{era_rsa_model}
\alias{era_rsa_model}
\title{ERA-RSA: Encoding–Retrieval Similarity and ER Geometry}
\usage{
era_rsa_model(
  dataset,
  design,
  key_var,
  phase_var,
  encoding_level = NULL,
  retrieval_level = NULL,
  distfun = cordist(method = "pearson"),
  rsa_simfun = c("pearson", "spearman"),
  confound_rdms = NULL,
  include_diag = TRUE,
  item_block = NULL,
  item_lag = NULL,
  item_run_enc = NULL,
  item_run_ret = NULL,
  ...
)
}
\arguments{
\item{dataset}{An mvpa_dataset with train_data (encoding) and test_data (retrieval).}

\item{design}{An mvpa_design describing trial structure with train/test designs.}

\item{key_var}{Column name or formula giving the item key that links encoding
and retrieval trials (e.g., ~ ImageID).}

\item{phase_var}{Column name or formula giving phase labels (must include
encoding and retrieval levels if using a single-phase dataset; for the
default two-dataset usage, this is still parsed for consistency but not
required for operations).}

\item{encoding_level}{Level of phase_var to treat as encoding (default: first level).}

\item{retrieval_level}{Level of phase_var to treat as retrieval (default: second level).}

\item{distfun}{A distfun used to compute within-phase RDMs (e.g., cordist("pearson")).}

\item{rsa_simfun}{Character: similarity for comparing RDMs, one of "pearson" or "spearman".}

\item{confound_rdms}{Optional named list of KxK matrices or "dist" objects (item-level
nuisance/model RDMs), e.g., block/run/time.}

\item{include_diag}{Logical; if TRUE (default) ERA off-diagonal mean excludes diagonal
by setting it to NA first; diagonal metrics are always retained.}

\item{item_block}{Optional factor of per-item blocks, aligned to item keys.}

\item{item_lag}{Optional numeric per-item retrieval-minus-encoding lag, aligned to item keys.}

\item{item_run_enc}{Optional factor of per-item encoding runs.}

\item{item_run_ret}{Optional factor of per-item retrieval runs.}

\item{...}{Additional fields stored on the model spec.}
}
\value{
A model spec of class "era_rsa_model" compatible with run_regional()/run_searchlight().
}
\description{
Combines first-order encoding–retrieval similarity (ERA) with second-order
RSA between encoding and retrieval representational geometries. Works with
run_regional() and run_searchlight() using the standard rMVPA iterators.
}
\details{
Key outputs per ROI/searchlight sphere include:
- First-order ERA: top-1 accuracy, diagonal mean, diagonal-minus-off.
- Second-order geometry: correlation between encoding and retrieval RDMs.
- Optional confound-aware metrics and diagnostics (block/lag/run).
}
