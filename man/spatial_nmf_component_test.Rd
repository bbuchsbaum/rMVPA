% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spatial_nmf_inference.R
\name{spatial_nmf_component_test}
\alias{spatial_nmf_component_test}
\title{Component-level Inference for Spatial NMF}
\usage{
spatial_nmf_component_test(
  fit = NULL,
  W = NULL,
  groups = NULL,
  covariates = NULL,
  test = c("two_group", "one_group"),
  nperm = 1000,
  correction = c("maxT", "none"),
  alternative = c("two.sided", "greater"),
  null_W = NULL,
  alpha = 0.05,
  seed = NULL,
  return_perm = FALSE
)
}
\arguments{
\item{fit}{A spatial_nmf_fit object containing a W matrix.}

\item{W}{Optional n x k matrix of loadings (overrides fit$W).}

\item{groups}{Factor or vector of group labels (length n); required for two-group tests.}

\item{covariates}{Optional data frame of covariates (n rows).}

\item{test}{One of "two_group" or "one_group".}

\item{nperm}{Number of permutations (ignored for one_group if null_W provided).}

\item{correction}{One of "maxT" or "none".}

\item{alternative}{Alternative hypothesis: "two.sided" or "greater". For two_group
tests, "greater" evaluates positive differences for the second factor level
relative to the first.}

\item{null_W}{Null distribution of W for one-group inference (list or 3D array).}

\item{alpha}{Significance threshold for counting significant components.}

\item{seed}{Optional RNG seed for permutations.}

\item{return_perm}{Logical; return permutation statistics.}
}
\value{
A list with a component-level results table and summary stats.
}
\description{
Permutation-based inference for component significance using NMF loadings.
Supports two-group tests (label permutations) and one-group tests given a
null distribution of loadings.
}
