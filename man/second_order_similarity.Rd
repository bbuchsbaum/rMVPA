% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vector_rsa_model.R
\name{second_order_similarity}
\alias{second_order_similarity}
\title{Compute Second-Order Similarity Scores}
\usage{
second_order_similarity(
  distfun,
  X,
  Dref,
  block_var,
  method = c("pearson", "spearman")
)
}
\arguments{
\item{distfun}{An S3 distance object (see \code{\link{create_dist}}) 
specifying how to compute a pairwise distance matrix from \code{X}.}

\item{X}{A numeric matrix (rows = observations, columns = features).}

\item{Dref}{A numeric NxN reference matrix of dissimilarities (e.g., from an ROI mask or a prior).}

\item{block_var}{A vector indicating block/group memberships for each row in \code{X}.}

\item{method}{Correlation method: "pearson" or "spearman".}
}
\value{
A numeric vector of length \code{nrow(X)}, where each entry is
the correlation (using \code{method}) between \code{distance_matrix[i, valid]} and
\code{Dref[i, valid]}, with \code{valid = which(block_var != block_var[i])}.
}
\description{
Calculates correlation-based \emph{second order similarity} between:
\itemize{
  \item A \strong{full NxN distance matrix} computed from \code{X} via \code{distfun}, and 
  \item A \code{Dref} matrix (the "reference" dissimilarities).
}
For each row \code{i}, this excludes same-block comparisons by selecting \code{which(block_var != block_var[i])}.
}
\details{
This function first calls \code{pairwise_dist(distfun, X)}, obtaining an NxN matrix 
of \emph{all} pairwise distances. It does not do block-based exclusion internally. 
Instead, for each row \code{i}, it excludes same-block rows from the correlation 
by subsetting the distances to \code{valid_indices}.
}
\examples{
# Suppose we have X (10x5), a reference D (10x10), block var, and a correlation distfun:
X <- matrix(rnorm(50), 10, 5)
D <- matrix(runif(100), 10, 10)
block <- rep(1:2, each=5)
dist_obj <- cordist(method="pearson")
scores <- second_order_similarity(dist_obj, X, D, block, method="spearman")

}
