% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spatial_nmf_inference.R
\name{spatial_nmf_global_test}
\alias{spatial_nmf_global_test}
\title{Global Cross-validated Group Test for Spatial NMF}
\usage{
spatial_nmf_global_test(
  x = NULL,
  X = NULL,
  groups = NULL,
  k = NULL,
  lambda = NULL,
  graph = NULL,
  neighbors = 6,
  nfolds = 5,
  folds = NULL,
  nperm = 1000,
  metric = c("auc", "accuracy"),
  classifier = c("glm", "lda", "centroid"),
  scale = TRUE,
  positive = NULL,
  seed = NULL,
  project_args = list(max_iter = 100, check_every = 5),
  return_perm = FALSE,
  return_cv = FALSE,
  ...
)
}
\arguments{
\item{x}{Optional spatial_nmf_maps_result with return_data=TRUE.}

\item{X}{Optional subject-by-voxel matrix (overrides x$data).}

\item{groups}{Factor or vector of group labels (length n).}

\item{k}{Number of components (defaults to x$fit$k if available).}

\item{lambda}{Spatial regularization strength (defaults to x$fit$lambda if available).}

\item{graph}{Optional graph Laplacian list (required if lambda > 0).}

\item{neighbors}{Neighborhood size for volumetric adjacency (6/18/26).}

\item{nfolds}{Number of cross-validation folds.}

\item{folds}{Optional fold specification (vector of fold IDs or list of test indices).}

\item{nperm}{Number of label permutations.}

\item{metric}{Performance metric: "auc" or "accuracy".}

\item{classifier}{Classifier: "glm", "lda", or "centroid".}

\item{scale}{Logical; z-score W within each fold.}

\item{positive}{Optional positive class label (defaults to second factor level).}

\item{seed}{Optional RNG seed.}

\item{project_args}{List of arguments passed to spatial_nmf_project.}

\item{return_perm}{Logical; return permutation statistics.}

\item{return_cv}{Logical; return cross-validated predictions and fold IDs.}

\item{...}{Additional arguments passed to spatial_nmf_fit.}
}
\value{
A list with the observed statistic, permutation p-value, and metadata.
}
\description{
Performs a permutation-based global test by cross-validating a classifier
on NMF component loadings learned within each fold.
}
