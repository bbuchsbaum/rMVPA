% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spatial_nmf.R
\name{spatial_nmf_maps}
\alias{spatial_nmf_maps}
\title{Spatial NMF on Map Lists}
\usage{
spatial_nmf_maps(
  group_A,
  group_B = NULL,
  mask = NULL,
  dims = NULL,
  k,
  lambda = 0,
  graph = NULL,
  neighbors = 6,
  na_action = c("zero", "error"),
  return_maps = TRUE,
  return_data = FALSE,
  component_test = NULL,
  global_test = NULL,
  stability = NULL,
  ...
)
}
\arguments{
\item{group_A}{List of NeuroVol/NeuroSurface maps for group A.}

\item{group_B}{Optional list of NeuroVol/NeuroSurface maps for group B.}

\item{mask}{Mask object for volumetric data (NeuroVol or logical/numeric vector).
Required for volumetric inputs; optional for surface inputs.}

\item{dims}{Optional spatial dimensions for volumetric masks given as vectors.}

\item{k}{Number of components.}

\item{lambda}{Spatial regularization strength (0 = none).}

\item{graph}{Optional graph Laplacian list (from build_graph_laplacian).}

\item{neighbors}{Neighborhood size for volumetric adjacency (6/18/26).}

\item{na_action}{How to handle NA values in maps: "zero" or "error".}

\item{return_maps}{Logical; return component maps as NeuroVol/NeuroSurface.}

\item{return_data}{Logical; include the data matrix in the result.}

\item{component_test}{NULL to skip, TRUE for defaults, or a list of arguments
passed to spatial_nmf_component_test.}

\item{global_test}{NULL to skip, TRUE for defaults, or a list of arguments
passed to spatial_nmf_global_test.}

\item{stability}{NULL to skip, TRUE for defaults, or a list of arguments
passed to spatial_nmf_stability.}

\item{...}{Additional arguments passed to spatial_nmf_fit.}
}
\value{
A list with fields:
  \itemize{
    \item fit: spatial_nmf_fit object.
    \item components: list of spatial component maps (if return_maps).
    \item groups: factor of group labels for each subject.
    \item mask_indices: indices used to vectorize maps.
    \item map_type: "volume" or "surface".
    \item data: subject-by-voxel matrix (if return_data).
    \item component_test: component-level inference (if requested).
    \item global_test: global CV permutation test (if requested).
    \item stability: stability results (if requested).
  }
}
\description{
Convenience wrapper that converts lists of NeuroVol/NeuroSurface maps into
a subject-by-voxel matrix and fits spatially regularized NMF.
}
