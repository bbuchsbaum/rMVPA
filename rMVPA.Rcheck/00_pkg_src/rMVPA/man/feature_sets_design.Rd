% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/feature_sets_design.R
\name{feature_sets_design}
\alias{feature_sets_design}
\title{Feature-sets design (mvpa_design extension for continuous regression)}
\usage{
feature_sets_design(
  X_train,
  X_test = NULL,
  block_var_test = NULL,
  split_by = NULL
)
}
\arguments{
\item{X_train}{A `feature_sets` object (train/source predictors).}

\item{X_test}{Optional `feature_sets` object (test/target predictors).}

\item{block_var_test}{Optional integer/factor vector of length T_rec defining
test/target blocks (typically runs). Used by models that do test-time CV.}

\item{split_by}{Optional split definition passed to `mvpa_design`.}
}
\value{
An object inheriting from `mvpa_design` with class `feature_sets_design`.
}
\description{
`feature_sets_design()` defines a small `mvpa_design` extension that attaches
grouped continuous predictors for stimulus→brain regression.
}
\details{
This mirrors the pattern in `hrfdecoder_design()`: rMVPA's core infrastructure
expects `mvpa_design` fields like `train_design`, `y_train`, etc. For continuous
regression with external test domains, those fields are largely bookkeeping,
while the \emph{actual} predictors are carried explicitly as `feature_sets` objects.


\strong{Where the data live.}
\itemize{
  \item Predictors live on the design: `design$X_train` and `design$X_test` (both `feature_sets`).
  \item Responses live on the dataset: `dataset$train_data` and `dataset$test_data` (TR×voxel matrices per ROI).
}

\strong{Why `y_train` is a dummy.}
The returned object includes a dummy `y_train = 1:T_enc` (and `y_test = 1:T_rec` when
`X_test` is present). This is only to satisfy length checks and indexing in the
generic rMVPA iterators. Models built for this design (e.g. `grouped_ridge_da_model()` /
`banded_ridge_da_model()`)
should ignore `y_train` and use `design$X_train` / `design$X_test` instead.

\strong{Recall blocks.}
`block_var_test` is stored for convenience as `design$block_var_test`. Models can use it
to define blocked cross-validation on test/target time (e.g. leave-one-run-out), and fall back
to contiguous folds when only a single run is present.
}
\examples{
# Train predictors (TR × features), split into named sets:
X_enc <- matrix(rnorm(20 * 8), 20, 8)
fs_enc <- feature_sets(X_enc, blocks(low = 3, sem = 5))

# Test predictors (TR × features), for example from a soft alignment:
gamma <- matrix(runif(10 * 20), 10, 20)
gamma <- gamma / rowSums(gamma)
fs_rec <- expected_features(fs_enc, gamma, drop_null = FALSE, renormalize = TRUE)

des <- feature_sets_design(fs_enc, fs_rec, block_var_test = rep(1:2, each = 5))
}
\seealso{
\code{\link{feature_sets}}, \code{\link{expected_features}},
  \code{\link{banded_ridge_da_model}}, \code{\link{grouped_ridge_da_model}},
  \code{\link{banded_ridge_da}}, \code{\link{grouped_ridge_da}}
}
